[
  {
    "id": "sqli_flask_concat_019",
    "type": "sqli",
    "subtype": "flask_concat",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get', methods=['POST'])\ndef authenticate():\n    q = request.form.get('q')\n    password = request.form.get('password')\n    # VULNERABILITY: String concatenation in SQL\n    query = \"SELECT * FROM accounts WHERE login = '\" + q + \"' AND password = '\" + password + \"'\"\n    conn = sqlite3.connect('app.db')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    user = cursor.fetchone()\n    conn.close()\n    if user:\n        return jsonify({\"status\": \"authenticated\"})\n    return jsonify({\"status\": \"failed\"}), 401\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get', methods=['POST'])\ndef authenticate():\n    q = request.form.get('q')\n    password = request.form.get('password')\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM accounts WHERE login = ? AND password = ?\"\n    conn = sqlite3.connect('app.db')\n    cursor = conn.cursor()\n    cursor.execute(query, (q, password))  # <--- PARAMETERIZED\n    user = cursor.fetchone()\n    conn.close()\n    if user:\n        return jsonify({\"status\": \"authenticated\"})\n    return jsonify({\"status\": \"failed\"}), 401\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl -X POST '/get' -d 'q=admin' OR '1'='1'--&password=x'",
    "param_name": "q",
    "route": "/get",
    "generated_at": "2026-01-17T18:04:33.584402"
  },
  {
    "id": "sqli_fastapi_fstring_007",
    "type": "sqli",
    "subtype": "fastapi_fstring",
    "vulnerable_code": "import sqlite3\nfrom fastapi import FastAPI, Query\n\napp = FastAPI()\n\n@app.get(\"/api/user\")\nasync def search(name: str = Query(...)):\n    # VULNERABILITY: f-string in SQL\n    query = f\"SELECT * FROM customers WHERE login = '{name}'\"\n    conn = sqlite3.connect(\"database.db\")\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return {\"results\": results}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
    "secure_code": "import sqlite3\nfrom fastapi import FastAPI, Query\n\napp = FastAPI()\n\n@app.get(\"/api/user\")\nasync def search(name: str = Query(...)):\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM customers WHERE login = ?\"\n    conn = sqlite3.connect(\"database.db\")\n    cursor = conn.cursor()\n    cursor.execute(query, (name,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return {\"results\": results}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
    "exploit_command": "curl '/api/user?name=' OR '1'='1'--",
    "param_name": "name",
    "route": "/api/user",
    "generated_at": "2026-01-17T18:04:33.583253"
  },
  {
    "id": "sqli_flask_fstring_021",
    "type": "sqli",
    "subtype": "flask_fstring",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/fetch')\ndef search():\n    name = request.args.get('name')\n    # VULNERABILITY: Direct f-string interpolation in SQL query\n    query = f\"SELECT * FROM admins WHERE login = '{ name }'\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/fetch')\ndef search():\n    name = request.args.get('name')\n    # SECURE: Parameterized query with placeholder\n    query = \"SELECT * FROM admins WHERE login = ?\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    cursor.execute(query, (name,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl '/fetch?name=' OR '1'='1' --",
    "param_name": "name",
    "route": "/fetch",
    "generated_at": "2026-01-17T18:04:33.584572"
  },
  {
    "id": "sqli_raw_execute_000",
    "type": "sqli",
    "subtype": "raw_execute",
    "vulnerable_code": "import sqlite3\n\ndef get_user(name):\n    \"\"\"Get user from database\"\"\"\n    conn = sqlite3.connect(\"users.db\")\n    cursor = conn.cursor()\n    # VULNERABILITY: String interpolation in execute\n    cursor.execute(\"SELECT * FROM profiles WHERE email = '%s'\" % name)\n    result = cursor.fetchone()\n    conn.close()\n    return result\n\n# Example usage\nif __name__ == \"__main__\":\n    user_input = input(\"Enter name: \")\n    print(get_user(user_input))\n",
    "secure_code": "import sqlite3\n\ndef get_user(name):\n    \"\"\"Get user from database\"\"\"\n    conn = sqlite3.connect(\"users.db\")\n    cursor = conn.cursor()\n    # SECURE: Parameterized query\n    cursor.execute(\"SELECT * FROM profiles WHERE email = ?\", (name,))\n    result = cursor.fetchone()\n    conn.close()\n    return result\n\n# Example usage\nif __name__ == \"__main__\":\n    user_input = input(\"Enter name: \")\n    print(get_user(user_input))\n",
    "exploit_command": "echo \"' OR '1'='1\" | python script.py",
    "param_name": "name",
    "route": null,
    "generated_at": "2026-01-17T18:04:33.582421"
  },
  {
    "id": "sqli_flask_concat_028",
    "type": "sqli",
    "subtype": "flask_concat",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/user', methods=['POST'])\ndef authenticate():\n    email = request.form.get('email')\n    password = request.form.get('password')\n    # VULNERABILITY: String concatenation in SQL\n    query = \"SELECT * FROM users WHERE username = '\" + email + \"' AND password = '\" + password + \"'\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    user = cursor.fetchone()\n    conn.close()\n    if user:\n        return jsonify({\"status\": \"authenticated\"})\n    return jsonify({\"status\": \"failed\"}), 401\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/user', methods=['POST'])\ndef authenticate():\n    email = request.form.get('email')\n    password = request.form.get('password')\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query, (email, password))  # <--- PARAMETERIZED\n    user = cursor.fetchone()\n    conn.close()\n    if user:\n        return jsonify({\"status\": \"authenticated\"})\n    return jsonify({\"status\": \"failed\"}), 401\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl -X POST '/user' -d 'email=admin' OR '1'='1'--&password=x'",
    "param_name": "email",
    "route": "/user",
    "generated_at": "2026-01-17T18:04:33.585455"
  },
  {
    "id": "sqli_flask_fstring_040",
    "type": "sqli",
    "subtype": "flask_fstring",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get')\ndef search():\n    term = request.args.get('term')\n    # VULNERABILITY: Direct f-string interpolation in SQL query\n    query = f\"SELECT * FROM customers WHERE name = '{ term }'\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get')\ndef search():\n    term = request.args.get('term')\n    # SECURE: Parameterized query with placeholder\n    query = \"SELECT * FROM customers WHERE name = ?\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query, (term,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl '/get?term=' OR '1'='1' --",
    "param_name": "term",
    "route": "/get",
    "generated_at": "2026-01-17T18:04:33.586452"
  },
  {
    "id": "sqli_flask_format_016",
    "type": "sqli",
    "subtype": "flask_format",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/user')\ndef get_user():\n    name = request.args.get('name', '')\n    # VULNERABILITY: String format in SQL query\n    query = \"SELECT * FROM admins WHERE user_id = '{}'\".format(name)\n    conn = sqlite3.connect('data.db')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/user')\ndef get_user():\n    name = request.args.get('name', '')\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM admins WHERE user_id = ?\"\n    conn = sqlite3.connect('data.db')\n    cursor = conn.cursor()\n    cursor.execute(query, (name,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl '/user?name=admin'--",
    "param_name": "name",
    "route": "/user",
    "generated_at": "2026-01-17T18:04:33.584107"
  },
  {
    "id": "sqli_raw_execute_044",
    "type": "sqli",
    "subtype": "raw_execute",
    "vulnerable_code": "import sqlite3\n\ndef get_user(id):\n    \"\"\"Get user from database\"\"\"\n    conn = sqlite3.connect(\"data.db\")\n    cursor = conn.cursor()\n    # VULNERABILITY: String interpolation in execute\n    cursor.execute(\"SELECT * FROM users WHERE user_id = '%s'\" % id)\n    result = cursor.fetchone()\n    conn.close()\n    return result\n\n# Example usage\nif __name__ == \"__main__\":\n    user_input = input(\"Enter id: \")\n    print(get_user(user_input))\n",
    "secure_code": "import sqlite3\n\ndef get_user(id):\n    \"\"\"Get user from database\"\"\"\n    conn = sqlite3.connect(\"data.db\")\n    cursor = conn.cursor()\n    # SECURE: Parameterized query\n    cursor.execute(\"SELECT * FROM users WHERE user_id = ?\", (id,))\n    result = cursor.fetchone()\n    conn.close()\n    return result\n\n# Example usage\nif __name__ == \"__main__\":\n    user_input = input(\"Enter id: \")\n    print(get_user(user_input))\n",
    "exploit_command": "echo \"' OR '1'='1\" | python script.py",
    "param_name": "id",
    "route": null,
    "generated_at": "2026-01-17T18:04:33.586779"
  },
  {
    "id": "sqli_flask_fstring_002",
    "type": "sqli",
    "subtype": "flask_fstring",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/fetch')\ndef search():\n    search = request.args.get('search')\n    # VULNERABILITY: Direct f-string interpolation in SQL query\n    query = f\"SELECT * FROM employees WHERE name = '{ search }'\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/fetch')\ndef search():\n    search = request.args.get('search')\n    # SECURE: Parameterized query with placeholder\n    query = \"SELECT * FROM employees WHERE name = ?\"\n    conn = sqlite3.connect('db.sqlite')\n    cursor = conn.cursor()\n    cursor.execute(query, (search,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl '/fetch?search=' OR '1'='1' --",
    "param_name": "search",
    "route": "/fetch",
    "generated_at": "2026-01-17T18:04:33.582726"
  },
  {
    "id": "sqli_flask_format_038",
    "type": "sqli",
    "subtype": "flask_format",
    "vulnerable_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/query')\ndef get_user():\n    email = request.args.get('email', '')\n    # VULNERABILITY: String format in SQL query\n    query = \"SELECT * FROM accounts WHERE user_id = '{}'\".format(email)\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "secure_code": "import sqlite3\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/query')\ndef get_user():\n    email = request.args.get('email', '')\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM accounts WHERE user_id = ?\"\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    cursor.execute(query, (email,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return jsonify(results)\n\nif __name__ == '__main__':\n    app.run(debug=True, port=5000)\n",
    "exploit_command": "curl '/query?email=admin'--",
    "param_name": "email",
    "route": "/query",
    "generated_at": "2026-01-17T18:04:33.586287"
  }
]