{
  "id": "sqli_fastapi_fstring_007",
  "type": "sqli",
  "subtype": "fastapi_fstring",
  "vulnerable_code": "import sqlite3\nfrom fastapi import FastAPI, Query\n\napp = FastAPI()\n\n@app.get(\"/api/user\")\nasync def search(name: str = Query(...)):\n    # VULNERABILITY: f-string in SQL\n    query = f\"SELECT * FROM customers WHERE login = '{name}'\"\n    conn = sqlite3.connect(\"database.db\")\n    cursor = conn.cursor()\n    cursor.execute(query)  # <--- SQL INJECTION HERE\n    results = cursor.fetchall()\n    conn.close()\n    return {\"results\": results}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
  "secure_code": "import sqlite3\nfrom fastapi import FastAPI, Query\n\napp = FastAPI()\n\n@app.get(\"/api/user\")\nasync def search(name: str = Query(...)):\n    # SECURE: Parameterized query\n    query = \"SELECT * FROM customers WHERE login = ?\"\n    conn = sqlite3.connect(\"database.db\")\n    cursor = conn.cursor()\n    cursor.execute(query, (name,))  # <--- PARAMETERIZED\n    results = cursor.fetchall()\n    conn.close()\n    return {\"results\": results}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
  "exploit_command": "curl '/api/user?name=' OR '1'='1'--",
  "param_name": "name",
  "route": "/api/user",
  "generated_at": "2026-01-17T18:04:33.583253"
}