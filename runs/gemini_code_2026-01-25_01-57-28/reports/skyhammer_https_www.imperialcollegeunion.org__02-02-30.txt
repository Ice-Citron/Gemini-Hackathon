============================================================
SKYHAMMER REPORT
============================================================
Target: https://www.imperialcollegeunion.org/
Timestamp: 2026-01-25T02:02:30.205019
============================================================

----------------------------------------
VULNERABILITY REPORT: mock_imperial_portal.py
----------------------------------------

[CRITICAL] SQL Injection in /login
  Status: EXPLOITED
  Proof: curl -X POST ".../login" -d "username=admin' OR '1'='1"
  Response: LOGIN SUCCESS! Welcome back, admin. Your password is: super_secret_password_123

BEFORE (vulnerable):
  query = f"SELECT * FROM users WHERE username = '{username}'"
  cursor.execute(query)

AFTER (secure):
  query = "SELECT * FROM users WHERE username = ?"
  cursor.execute(query, (username,))

Hacker's Note:
  The attacker input ' OR '1'='1 modifies the SQL query logic.
  '1'='1' is always TRUE, so the database returns the first record (admin)
  regardless of the password. Parameterized queries prevent this by treating
  input strictly as data, not executable code.

----------------------------------------

[HIGH] Command Injection in /check_status
  Status: EXPLOITED
  Proof: curl ".../check_status?host=localhost;echo%20SYSTEM_COMPROMISED"
  Response: SYSTEM_COMPROMISED

BEFORE (vulnerable):
  cmd = f"ping -c 1 {host}"
  output = subprocess.check_output(cmd, shell=True)

AFTER (secure):
  if not re.match(r'^[a-zA-Z0-9.-]+$', host): return "Invalid"
  cmd = ["ping", "-c", "1", host]
  output = subprocess.check_output(cmd) # shell=False

Hacker's Note:
  The 'shell=True' argument allows the shell to interpret ';'.
  This enables chaining commands. The fix disables shell interpretation
  and strictly validates the hostname format.

----------------------------------------

[MEDIUM] Reflected XSS in /search
  Status: EXPLOITED
  Proof: curl ".../search?q=<script>alert('HACKED')</script>"
  Response: Search results for: <script>alert('HACKED')</script>

BEFORE (vulnerable):
  return f"Search results for: {query}"

AFTER (secure):
  from markupsafe import escape
  return f"Search results for: {escape(query)}"

Hacker's Note:
  The browser executes the <script> tag because the server echoes it back raw.
  Escaping converts special chars (like < to &lt;) so they display as text
  instead of running as code.

----------------------------------------
REMEDIATION COMPLETE
Target file 'mock_imperial_portal.py' has been patched and verified secure.
----------------------------------------